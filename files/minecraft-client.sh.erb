#!/usr/bin/env sh

USERNAME="<%= username %>"
VERSION="<%= version %>"

UUID="<%= uuid.tr("-","") %>"
ACCESS_TOKEN=""

APP="/Applications/Minecraft.app"
APP_SUPPORT="$HOME/Library/Application Support/minecraft"

JAVA_HOME="<%= java_home %>"

CLASSPATH="<%= jars.shift %>"
<% jars.each do |jar| %>
CLASSPATH="$CLASSPATH:<%= jar %>"
<% end %>

# remove log files older than 30 days
/usr/bin/find logs -mtime +30 -exec rm {} \;

# start the Minecraft client
exec $JAVA_HOME/bin/java \
  -Xdock:name=Minecraft \
  -Xms512M -Xmx2G -Xmn128M \
  -XX:+UseConcMarkSweepGC \
  -XX:+CMSIncrementalMode \
  -XX:-UseAdaptiveSizePolicy \
  -Dlog4j.configurationFile="$APP_SUPPORT/assets/log_configs/client-<%= minor_version %>.xml" \
  -Dminecraft.client.jar="$APP_SUPPORT/versions/$VERSION/$VERSION.jar" \
  -Dminecraft.launcher.brand=minecraft-launcher \
<% java_opts.each do |opt| %>
  <%= opt %> \
<% end %>
  -Djava.library.path="natives" \
  -cp "$CLASSPATH" \
  net.minecraft.client.main.Main \
  --username "$USERNAME" \
  --version "$VERSION" \
  --gameDir "$APP_SUPPORT" \
  --assetsDir "$APP_SUPPORT/assets" \
  --assetIndex <%= minor_version %> \
  --uuid "$UUID" \
  --accessToken "$ACCESS_TOKEN" \
  --userType mojang \
  --versionType release


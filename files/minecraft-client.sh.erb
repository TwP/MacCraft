#!/usr/bin/env sh

USERNAME="<%= username %>"
VERSION="<%= version %>"

UUID="<%= uuid.tr("-","") %>"
ACCESS_TOKEN=""

APP="/Applications/Minecraft.app"
APP_SUPPORT="$HOME/Library/Application Support/minecraft"
APP_ICON="<%= app_icon %>"

JAVA_HOME="<%= java_home %>"

CLASSPATH="<%= jars.shift %>"
<% jars.each do |jar| %>
CLASSPATH="$CLASSPATH:<%= jar %>"
<% end %>

# remove log files older than 30 days
/usr/bin/find logs -mtime +30 -exec rm {} \;

# start the Minecraft client
exec $JAVA_HOME/bin/java \
  -Xdock:icon="$APP_ICON" \
  -Xdock:name=Minecraft \
  -Xms512M -Xmx1G -Xmn128M \
  -XX:+UseConcMarkSweepGC \
  -XX:+CMSIncrementalMode \
  -XX:-UseAdaptiveSizePolicy \
  -Djava.library.path="natives" \
  -cp "$CLASSPATH" \
  net.minecraft.client.main.Main \
  --username "$USERNAME" \
  --version "$VERSION" \
  --gameDir "$APP_SUPPORT" \
  --assetsDir "$APP_SUPPORT/assets" \
  --assetIndex <%= minor_version %> \
  --uuid "$UUID" \
  --accessToken "$ACCESS_TOKEN" \
  --userProperties {} \
  --userType mojang \
  --versionType release \
  --nativePath "$APP" \
  --nativeStartupPath "$APP/Contents" \
  --nativeExecutable "$APP/Contents/MacOS/launcher" \
  --nativeLauncherVersion <%= launcher_version %>

